from sympy import isprime

def encrypt(m, n, e):

    c = pow(m, e, n)

    return c


def decrypt(c, d, n):

    m = pow(c, d, n)

    return m

p = 18166460424236298325314525734466524513235789312213143718477430047779259822287592427

print(isprime(p))
q = 14368992118893453829853991050279439205227178923835819491943320752646830162695928653
print(isprime(q))
n = p*q

func_oyler_n=(p-1)*(q-1)
e = 10001
d=pow(e, -1, func_oyler_n)

m = 555410482552174672724202679696689063420514689183023139598028389916620680442315597258260234085273646619990759270353558971732146
print(f'то наше повідомлення: {m}')
c = encrypt(m, n, e)
print(f'то наш шифротекст: {c}')
mess = decrypt(c, d, n)
print(f'пробуємо розшифрувати: {mess}')
if mess != m:
    print('damn...\n')
    
m2 = 77
p2 = 27
q2 = 32
n2 = p2*q2 #864
e2 = 17
d2 = 569
print(f'то наше повідомлення: {m2}')

c2 = encrypt(m2, n2, e2)
print(f'то наш шифротекст: {c2}')

message = decrypt(c2, d2, n2)
print(f'пробуємо розшифрувати: {message}')

"""

m2 = 7875
p2 = 1787
q2 = 1997
n2 = p2*q2 #3568639
e2 = 65537
d2 = 1604585
print(f'то наше повідомлення: {m2}')

c2 = encrypt(m2, n2, e2)
print(f'то наш шифротекст: {c2}')

message = decrypt(c2, d2, n2)
print(f'пробуємо розшифрувати: {message}')


p = 116862918623544248128319756100955064685651260864056191362225077673461753630388830651
q = 12038804167819470960333917511496708490805819076458216008426402823421543824671211623
n = p*q
print(f'то є наше n: {n}')

func_oyler_n=(p-1)*(q-1)
e = 10001
d=pow(e, -1, func_oyler_n)

print(f'то є наше d: {d}')

check = (e*d)%func_oyler_n
print(f'одиниця чи ні: {check}')


n = 1333
e = 67
func = 1260
d=pow(e, -1, func)

print(d)


m = 45
n = 1333
e = 67
d = 583
func = 1260

print(encrypt(m, n, e))

c = 887

print(decrypt(c, d, n))



n2 = 0x9fd8b5c8434d12e468b1eb2a1420de927289c1d1c39e1c6cb12e3e5b1b9cfb8f
e2 = 0x10001
d2 = 0x2c9f9357c5cd27cf20316ee4b0b71eb8c315da3c267d2b1e7f32eac4b1d86b61

m2 = 0x74883a932c4d9951625d94fa0f942a5309ad6183adf8107f578737a38850

print(hex(encrypt(m2, n2, e2)))

c2 = 0x9b3792d8c2d972e351d821d36a98632ca37c8f1bc868d14da46b81a81f7cb2b8

print(hex(decrypt(c2, d2, n2)))


p = 279379302127108761174569271058789554957
q = 258360274381301074208765305094405239607
e = 0x10001

n = p * q
phi = (p - 1) * (q - 1)

d = 0x2c9f9357c5cd27cf20316ee4b0b71eb8c315da3c267d2b1e7f32eac4b1d86b61

print((d * e) % phi)




m = 2638086300514661615170767565228071472077898138662844834766675288090406564630873986881221041299969482834975269
n = 231945321705982638086300514661615170767565228071472077898138662846460621638324708621319502325958980032929810987086734805587263850229515592139882146894176315482025871
e = 178584999235118522738056107644895014720441118253112434840688803879716500147964202454834766675288090406564630873986881221041299969482834975269886002580246825077036125

print(encrypt(m, n, e))


c = 135241165174764144633703638215935157528893700570044214574349144358308938103626665607749441179384345148659825025287872985776638333232754566890994033720582273236509715
n = 231945321705982638086300514661615170767565228071472077898138662846460621638324708621319502325958980032929810987086734805587263850229515592139882146894176315482025871
d = 159374875123665454259984469396788095838882392571517074425321616186106835804641984208083870477745531776248071581556229484553356789015161064579758560935910845790823045

print(decrypt(c, d, n))
"""
